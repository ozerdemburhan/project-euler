<!DOCTYPE html>
<head>
	<script src="helper.js"></script>
	<style type="text/css">
		body {
			font-family: monospace;
			font-size: 16px;
		}
		
	</style>
	<title>Test</title>	
	<meta charset="utf-8">
</head>

<body>
</body>

<script>
	var primes = [];
	start();

	function start() {
	    primes = preparePrimes(10000);

	    var p = getPermutations();
	    var size = getObjectSize(p);
	    document.write("size: " + (size) + "<br>");

	    for(var key in p) {
	        var arrKey = key.split(",");
	        var arr = getNumericPermutations(arrKey);
	        filterComposites(arr);

	        if(arr.length < 3) {
                delete p[key];
                continue;
            }

            var set = calculateDiffs(arr);

	        if(getObjectSize(set) > 0) {
                // document.write(key + ": " + arr + "<br>");
                document.write(arr + " " + JSON.stringify(set) + "<br>");
            }
	        // document.write("key: " + (key) + "<br>");
		}
	}

	function calculateDiffs(arr) {
	    var set = {};
	    for(var i = 0; i < arr.length - 1; i++) {
	        for(var j = i + 1; j < arr.length; j++) {
	            var diff = arr[j] - arr[i];
	            var count = set[diff];
	            if(!count) {
	                count = 0;
				}
				set[diff] = count + 1;
			}
		}

		for(var key in set) {
		    if(set[key] < 2) {
		        delete set[key];
			}
		}

		return set;
	}

	function filterComposites(arr) {
	    var length = arr.length;
	    for(var i = length - 1; i >= 0; i--) {
	        if(!isPrime(primes, arr[i])) {
	            arr.splice(i, 1);
			}
		}
	}

    function getNumericPermutations(arr) {
        var p = [];

        for(var p1 = 0; p1 < arr.length; p1++) {
            var t1 = arr[p1];
            var arr1 = arr.slice();
            arr1.splice(p1, 1);

            for(var p2 = 0; p2 < arr1.length; p2++) {
                var t2 = arr1[p2];
                var arr2 = arr1.slice();
                arr2.splice(p2, 1);

                for(var p3 = 0; p3 < arr2.length; p3++) {
                    var t3 = arr2[p3];
                    var arr3 = arr2.slice();
                    arr3.splice(p3, 1);

                    for(var p4 = 0; p4 < arr3.length; p4++) {
                        var t4 = arr3[p4];
                        var term = t1 + t2 + t3 + t4;
                        p.push(Number(term));
                    }
                }
            }
        }

        return p;
    }


	function getPermutations() {
        var arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];
        var set = {};

        for(var p1 = 0; p1 < arr.length; p1++) {
            var arr1 = arr.slice();
            arr1.splice(p1, 1);

            for(var p2 = 0; p2 < arr1.length; p2++) {
                var arr2 = arr1.slice();
                arr2.splice(p2, 1);

                for(var p3 = 0; p3 < arr2.length; p3++) {
                    var arr3 = arr2.slice();
                    arr3.splice(p3, 1);

                    for(var p4 = 0; p4 < arr3.length; p4++) {
                        var r = [arr[p1], arr1[p2], arr2[p3], arr3[p4]];
                        r.sort();
						set[r] = 1;
                    }
				}
			}
		}

		return set;

	}


</script>


</html>